<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>aadityaincode</title>
    <style>
        .terminal-locked {
            color: #e5e5e5;
            opacity: .6;
            transition: color 0.25s ease, opacity 0.25s ease;
        }

        .terminal-locked:hover {
            color: #39ff14 !important;
            opacity: 1;
        }

        .term-label {
            transition: color 0.25s ease;
        }

        .note-item.terminal:hover .term-label {
            color: #39ff14;
        }

        .bin-label {
            font-family: monospace;
            letter-spacing: 2px;
        }

        /* ===== FONT IMPORTS ===== */
        @font-face {
            font-family: 'Monaspace Krypton';
            src: url('fonts/MonaspaceKrypton-Regular.otf') format('opentype');
            font-weight: 400;
            font-style: normal;
        }
        
        @font-face {
            font-family: 'Monaspace Krypton';
            src: url('fonts/MonaspaceKrypton-Medium.otf') format('opentype');
            font-weight: 500;
            font-style: normal;
        }
        
        @font-face {
            font-family: 'Monaspace Krypton';
            src: url('fonts/MonaspaceKrypton-SemiBold.otf') format('opentype');
            font-weight: 600;
            font-style: normal;
        }
        
        @font-face {
            font-family: 'Monaspace Krypton';
            src: url('fonts/MonaspaceKrypton-Bold.otf') format('opentype');
            font-weight: 700;
            font-style: normal;
        }
        
        /* ===== CSS VARIABLES ===== */
        :root {
            --bg-dark: #1a1a1a;
            --card-bg: #0a0a0a;
            --sidebar-bg: #0a0a0a;
            --text-bg: #1a1a1a;
            --border-color: #4a4a4a;
            --text-primary: #ffffff;
            --text-secondary: #999999;
            --accent-purple: #a78bfa;
            --accent-pink: #ec4899;
            --semantic-green: #7dd3a7;
            
            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;
            
            --border-radius: 16px;
            --sidebar-width: 280px;
            --transition: all 0.3s ease;
        }
        
        /* ===== RESET ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* ===== BASE STYLES ===== */
        body {
            background-color: var(--bg-dark);
            color: var(--text-primary);
            font-family: 'Monaspace Krypton', monospace;
            font-weight: 400;
            line-height: 1.6;
            min-height: 100vh;
        }
        #wave-bg {
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
        }
        
        /* ===== LAYOUT ===== */
        .app {
            display: flex;
            min-height: 100vh;
        }
        
        /* ===== SIDEBAR ===== */
        .sidebar {
            width: var(--sidebar-width);
            background-color: #080808;
            border-right: 1px solid #333333;
            display: flex;
            flex-direction: column;
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
        }
        
        
        .sidebar__content {
            flex: 1;
            padding: var(--spacing-sm) var(--spacing-sm) var(--spacing-sm);
            overflow-y: auto;
        }
        .sidebar__top {
            padding: 0.75rem var(--spacing-sm);
            border-bottom: 1px solid #222222;
            background-color: #0b0b0b;
        }

        .sidebar__vault-title {
            font-size: 0.8rem;
            letter-spacing: 0.06em;
            text-transform: lowercase;
            color: var(--accent-purple);
            opacity: 0.85;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sidebar__logo {
            width: 20px;
            height: 20px;
            opacity: 0.85;
        }
        
        .sidebar__folder {
            margin-bottom: var(--spacing-xs);
        }
        
        .sidebar__folder-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            cursor: pointer;
            border-radius: 4px;
            transition: var(--transition);
            font-size: 0.9rem;
            opacity: 0.85;
        }
        .sidebar__folder-header:hover {
            background-color: #151515;
            opacity: 1;
        }
        
        .sidebar__folder-toggle {
            font-size: 0.75rem;
            color: var(--text-secondary);
            transition: transform 0.2s;
        }
        
        .sidebar__folder-toggle.open {
            transform: rotate(90deg);
        }
        
        .sidebar__folder-name {
            color: var(--text-primary);
        }
        
        .sidebar__folder-items {
            margin-left: 1.25rem;
            display: none;
        }
        .sidebar__item--socials:hover {
            color: var(--text-primary);
            border-left: 2px solid var(--accent-purple);
            padding-left: calc(0.5rem - 2px);
        }
        
        .sidebar__folder-items.open {
            display: block;
        }

        .sidebar__folder-skills {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            cursor: pointer;
            border-radius: 4px;
            transition: var(--transition);
            font-size: 0.9rem;
            opacity: 0.85;
            margin-left: 0;
            color: var(--text-primary);
            box-shadow: 0 0 8px rgba(139, 122, 255, 0.15);
        }

        .sidebar__folder-skills:hover {
            background-color: #151515;
            opacity: 1;
        }
        
        .sidebar__item {
            padding: 0.4rem 0.5rem;
            cursor: pointer;
            border-radius: 4px;
            transition: var(--transition);
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 2px;
        }
        
        .sidebar__item:hover {
            background-color: #151515;
            color: var(--text-primary);
        }
        
        .sidebar__item.active {
            background-color: #1a1a1a;
            color: var(--accent-purple);
            border-left: 2px solid var(--accent-purple);
            padding-left: calc(0.5rem - 2px);
        }
        
        .sidebar__footer {
            padding: var(--spacing-sm);
            border-top: 1px solid #222222;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1.25rem;
            background-color: #0d0d0d;
            min-height: 48px;
        }

        .sidebar__footer a {
            color: var(--text-secondary);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sidebar__footer a:hover {
            color: var(--accent-purple);
        }
        
        /* ===== MAIN CONTENT ===== */
        .main {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }


        .container {
            max-width: 600px;
            width: 100%;
            position: relative;
            z-index: 1;
            position: relative;
        }

        /* Use full note area for floating skills */
        body.skills-active .container{
            max-width: none;
            width: 100%;
            height: 100%;
            min-height: 70vh;
        }
        
        /* ===== HEADER ===== */
        .header {
            text-align: center;
            margin-bottom: calc(var(--spacing-xl) * 0.75);
        }
        
        .header__title {
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 700;
            background: linear-gradient(
                90deg,
                var(--text-primary),
                var(--accent-purple)
            );
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: var(--spacing-sm);
            animation: fadeInDown 0.8s ease-out;
            display: inline-block;
            padding: 0.25rem 0.5rem;
            position: relative;
        }
        
        /* ===== LABEL ===== */
        .label {
            color: var(--semantic-green);
            font-weight: 500;
            margin-right: 0.25rem;
            white-space: nowrap;
        }
        
        /* ===== CARD ===== */
        .card {
            background-color: rgba(10, 10, 10, 0.85);
            backdrop-filter: blur(2px);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1.75rem;
            margin-bottom: var(--spacing-xl);
            transition: var(--transition);
            animation: fadeInUp 0.8s ease-out;
            position: relative;
        }

        /* ===== KNOWLEDGE GRAPH (Obsidian-style, minimal) ===== */

        .graph-node {
            fill: rgba(167, 139, 250, 0.75);
            stroke: rgba(167, 139, 250, 0.9);
            stroke-width: 0.6;
        }

        .graph-edge {
            stroke: rgba(167, 139, 250, 0.35);
            stroke-width: 1;
            stroke-dasharray: 2 4;
        }

        .graph-label {
            font-size: 9px;
            fill: rgba(167, 139, 250, 0.75);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        #knowledge-graph:hover .graph-label {
            opacity: 1;
        }

        .sidebar__graph {
            padding: 0.25rem 0.75rem 0.5rem;
            background: transparent;
            opacity: 0.35;
            transition: opacity 0.35s ease;
        }

        .sidebar:hover .sidebar__graph {
            opacity: 0.85;
        }

        .sidebar__graph svg {
            width: 100%;
            height: 160px;
        }
        
        .card:hover {
            border-color: var(--accent-purple);
            transform: translateY(-2px);
        }
        
        .card__title {
            font-size: 2.5rem;
            font-weight: 600;
            color: var(--accent-purple);
            margin-bottom: var(--spacing-lg);
        }
        
        .card__content {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }
        
        .card__text-block {
            background-color: var(--text-bg);
            padding: var(--spacing-md);
            border-radius: 8px;
            border-left: 3px solid var(--accent-purple);
            padding-left: var(--spacing-md);
        }
        
        .card__text {
            color: var(--text-primary);
            font-size: 1rem;
            line-height: 1.8;
        }
        
        .card__highlight {
            color: var(--accent-purple);
            font-style: italic;
        }
        
        /* ===== HINT CARD ===== */
        .hint {
            background-color: rgba(10, 10, 10, 0.85);
            backdrop-filter: blur(2px);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1.25rem;
            max-width: 400px;
            margin: 0 auto;
            transition: var(--transition);
            animation: fadeInUp 0.8s ease-out 0.2s both;
            margin-top: var(--spacing-lg);
            opacity: 0.6;
            font-family: var(--mono-font, 'Monaspace Krypton', monospace);

        }

        .caret {
            display: inline-block;
            width: 0.2em;
            height: 1.05em;
            margin-left: 3px;
            vertical-align: -0.15em;
            background-color: #22c55e;
            visibility: hidden; /* hide until typing done */
        }

        @keyframes caret-blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .caret.blink {
            animation: caret-blink 1s step-end infinite;
        }

        .binary {
            color: #22c55e; /* calm green */
        }
        
        .hint:hover {
            border-color:  #428f5e;
            transform: translateY(-2px);
        }
        
        .hint__title {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--accent-purple);
            margin-bottom: 0.75rem;
            letter-spacing: 0.02em;
        }
        
        .hint__body {
            background-color: var(--text-bg);
            padding: 1rem;
            border-radius: 8px;
        }

        .hint__link {
            color: var(--text-primary);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            font-size: 1rem;
            transition: color 0.3s ease;
        }

        .hint__link:hover {
            color: #22c55e;
        }

        .hint__link::before {
            content: '←';
            font-size: 1.2rem;
        }
        
        /* ===== ANIMATIONS ===== */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
            
            .main {
                margin-left: 0;
            }
            
            .card,
            .hint {
                padding: var(--spacing-md);
            }
            
            .card__title,
            .hint__title {
                font-size: 2rem;
            }
        }
        @keyframes sidebar-glow {
            0% {
                box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
            }
            40% {
                box-shadow: 2px 0 20px rgba(167, 139, 250, 0.4);
            }
            70% {
                box-shadow: 2px 0 20px rgba(167, 139, 250, 0.4);
            }
            100% {
                box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
            }
        }


        @keyframes grid-breathe {
            0% {
                filter: opacity(0.75);
            }
            50% {
                filter: opacity(0.95);
            }
            100% {
                filter: opacity(0.8);
            }
        }

        @keyframes grid-drift {
            0% {
                background-position:
                    0px 0px,
                    0px 0px,
                    0% 0%,
                    0% 0%,
                    0% 0%;
            }
            50% {
                background-position:
                    4px -3px,
                    -3px 5px,
                    0% 0%,
                    0% 0%,
                    0% 0%;
            }
            100% {
                background-position:
                    0px 0px,
                    0px 0px,
                    0% 0%,
                    0% 0%,
                    0% 0%;
            }
        }

    .sidebar.glow {
        animation: sidebar-glow 1.2s ease-in-out;
    }

    @keyframes skills-glow {
        0% {
            box-shadow: 0 0 8px rgba(139, 122, 255, 0.15);
        }
        40% {
            box-shadow: 0 0 20px rgba(167, 139, 250, 0.6);
        }
        70% {
            box-shadow: 0 0 20px rgba(167, 139, 250, 0.6);
        }
        100% {
            box-shadow: 0 0 8px rgba(139, 122, 255, 0.15);
        }
    }

    .sidebar__folder-skills.glow {
        animation: skills-glow 1.2s ease-in-out;
    }

    /* Terminal styles */
    #boot-terminal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #0a0a0a;
        z-index: 9999;
        display: flex;
        align-items: flex-start;  /* ← Changed from center */
        justify-content: flex-start;  /* ← Changed from center */
        padding: 5vh 0 0 3vw;  /* ← Top and left padding instead */
    }

    #terminal-output {
        font-family: 'Monaspace Krypton', monospace;
        font-size: 0.95rem;
        line-height: 1.6;
        color: #e0e0e0;
        white-space: pre-wrap;
        padding: 0;  /* ← Remove internal padding since we're positioning it */
        max-width: 700px;
    }

    /* Prompt hierarchy */
    .prompt {
        color: #666666; /* muted - quieter than command */
        user-select: none;
    }

    .error {
        color: #ff6b6b;
    }

    /* Cursor behavior */
    .cursor {
        display: inline-block;
        width: 0.6em;
        height: 1.2em;
        margin-left: 2px;
        animation: none; /* no animation while typing */
        visibility: hidden; /* Hide caret by default; JS will control visibility */
    }

    .cursor.idle {
        animation: blink 1s step-end infinite; /* only blink when idle */
    }

    @keyframes blink {
        0%, 50% { opacity: 1; }
        51%, 100% { opacity: 0; }
    }

    /* Fade out */
    .boot-fade {
        animation: fadeOut 0.7s ease-out forwards;
    }

    @keyframes fadeOut {
        to {
            opacity: 0;
        }
    }

        /* ===== SKILLS CARDS (GLASS FLOATING) ===== */
        .skills-grid{
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        @media (max-width: 900px){
          .skills-grid{ grid-template-columns: repeat(3, 1fr); }
        }
        @media (max-width: 520px){
          .skills-grid{ grid-template-columns: repeat(2, 1fr); }
        }

        .skill-card{
            width: 96px;
            height: 96px;
            background: rgba(20,20,25,0.6);
            border-radius: 12px;
            backdrop-filter: blur(6px);
            -webkit-backdrop-filter: blur(6px);
            border: 1.5px solid rgba(64,64,64,0.8);
            box-shadow: inset 0 0 0 1px rgba(64,64,64,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform .3s ease, box-shadow .3s ease, border-color .3s ease;
            animation: float 3.5s ease-in-out infinite, borderPulse 2.4s ease-in-out 1;
            position: absolute;
            pointer-events: auto;
            animation: float 3.5s ease-in-out infinite, borderPulse 2.4s ease-in-out 1, drift 4s ease-in-out infinite;
        }
        @keyframes drift {
          0% { transform: translateY(-10px); }
          50% { transform: translateY(10px); }
          100% { transform: translateY(-10px); }
        }

        .skill-card:nth-child(1){ animation-delay: 0s; }
        .skill-card:nth-child(2){ animation-delay: .5s; }
        .skill-card:nth-child(3){ animation-delay: 1s; }
        .skill-card:nth-child(4){ animation-delay: 1.5s; }
        .skill-card:nth-child(5){ animation-delay: 2s; }

        @keyframes float{
            0%{ transform: translateY(0) rotate(0deg); }
            50%{ transform: translateY(-10px) rotate(1.5deg); }
            100%{ transform: translateY(0) rotate(0deg); }
        }

        @keyframes borderPulse{
          0%{ box-shadow: inset 0 0 0 1px rgba(0,255,170,0.9), 0 0 0 rgba(0,255,170,0); }
          50%{ box-shadow: inset 0 0 0 1px rgba(0,255,170,0.9), 0 0 16px rgba(0,255,170,0.35); }
          100%{ box-shadow: inset 0 0 0 1px rgba(64,64,64,0.8), 0 0 0 rgba(0,255,170,0); }
        }

        .skill-card img{
            width: 46px;
            height: 46px;
            opacity: .9;
            filter: brightness(1.2);
            transition: transform .3s ease, filter .3s ease;
        }

        .skill-card:hover{
            transform: translateY(-12px) scale(1.1);
            border-color: rgba(0,255,170,0.9);
            box-shadow: 0 0 20px rgba(0,255,170,.4);
        }

        .skill-card:hover img{
            filter: brightness(1.6) saturate(1.2);
            transform: scale(1.1);
        }

        #skills-bg{ display:none; }
    </style>
</head>
<body>
    
    <div id="boot-terminal">
        <pre id="terminal-output"></pre><span class="cursor">█</span>
    </div>
    <canvas id="wave-bg"></canvas>
    <canvas id="skills-bg"></canvas>
    <div class="app">
        <!-- SIDEBAR -->
        <aside class="sidebar">
            <div class="sidebar__top">
                <div class="sidebar__vault-title">
                    <svg class="sidebar__logo" viewBox="0 0 100 100" fill="none">
                        <!-- Outer octagon -->
                        <path d="M 30,10 L 70,10 L 90,30 L 90,70 L 70,90 L 30,90 L 10,70 L 10,30 Z"
                              stroke="currentColor" stroke-width="3" fill="none"/>
                        <!-- Inner octagon -->
                        <path d="M 37,22 L 63,22 L 78,37 L 78,63 L 63,78 L 37,78 L 22,63 L 22,37 Z"
                              stroke="currentColor" stroke-width="3" fill="none"/>
                        <!-- Green triangle -->
                        <polygon points="50,35 65,65 35,65" fill="#7dd3a7"/>
                        <!-- Right dashes (outer) -->
                        <line x1="92" y1="38" x2="92" y2="44" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                        <line x1="92" y1="48" x2="92" y2="54" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                        <line x1="92" y1="58" x2="92" y2="64" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                        <!-- Bottom-right dashes (inner) -->
                        <line x1="66" y1="80" x2="70" y2="80" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                        <line x1="73" y1="80" x2="77" y2="80" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                        <line x1="80" y1="80" x2="84" y2="80" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                    </svg>
                    aadityaincode
                </div>
            </div>
            <div class="sidebar__content">
                <!-- Whoami File -->
                <div class="sidebar__item active" onclick="loadContent('whoami')" style="margin-bottom: 1rem;">
                    00 - whoami
                </div>
                
                <!-- Projects Folder -->
                <div class="sidebar__folder">
                    <div class="sidebar__folder-header" onclick="toggleFolder('projects')">
                        <span class="sidebar__folder-toggle open" id="toggle-projects">▶</span>
                        <span class="sidebar__folder-name">01 - projects</span>
                    </div>
                    <div class="sidebar__folder-items open" id="folder-projects">
                        <div class="sidebar__item" onclick="loadContent('fts')">01- FTS</div>
                        <div class="sidebar__item" onclick="loadContent('touchline')">02 - TouchLine</div>
                        <!-- <div class="sidebar__item" onclick="loadContent('bmats')">03 - BMATS</div> -->
                        <!-- <div class="sidebar__item" onclick="loadContent('simpltimer')">04 - SimplTimer</div> -->
                    </div>
                </div>

                <!-- Skills File -->
                <div class="sidebar__folder-skills" onclick="loadContent('skills')">
                    <span class="sidebar__folder-toggle">▶</span>
                    <span class="sidebar__folder-name">02 - skills</span>
                </div>
                
                <!-- Notes Folder -->
                <div class="sidebar__folder">
                    <div class="sidebar__folder-header" onclick="toggleFolder('notes')">
                        <span class="sidebar__folder-toggle open" id="toggle-notes">▶</span>
                        <span class="sidebar__folder-name">03 - notes</span>
                    </div>
                    <div class="sidebar__folder-items open" id="folder-notes">
                        <div class="sidebar__item" onclick="loadContent('learning')">01 - learning</div>
                        <!-- <div class="sidebar__item" onclick="loadContent('music')">02 - music</div> -->
                        <div class="sidebar__item" onclick="loadContent('how-i-work')">02 - how-i-work</div>
                        <div class="sidebar__item terminal-locked note-item" onclick="openTerminalNote(event)">
                            <span class="bin-label" data-base="??">??</span> - terminal
                        </div>

                    </div>

                </div>
                
                <!-- Systems Folder
                <div class="sidebar__folder">
                    <div class="sidebar__folder-header" onclick="toggleFolder('systems')">
                        <span class="sidebar__folder-toggle open" id="toggle-systems">▶</span>
                        <span class="sidebar__folder-name">03 - systems</span>
                    </div>
                    <div class="sidebar__folder-items open" id="folder-systems">
                        <div class="sidebar__item" onclick="loadContent('how-i-work')">01 - how-i-work</div>
                    </div>
                </div> -->
                
                <!-- School Folder -->
                <!-- <div class="sidebar__folder">
                    <div class="sidebar__folder-header" onclick="toggleFolder('school')">
                        <span class="sidebar__folder-toggle" id="toggle-school">▶</span> -->
                        <!-- <span class="sidebar__folder-name">04 - school</span> -->
                    <!-- </div>
                    <div class="sidebar__folder-items" id="folder-school">
                    </div>
                </div> -->
                
                <!-- Meta Folder -->
                <div class="sidebar__folder">
                    <div class="sidebar__folder-header" onclick="toggleFolder('meta')">
                        <span class="sidebar__folder-toggle open" id="toggle-meta">▶</span>
                        <span class="sidebar__folder-name">04 - meta</span>
                    </div>
                    <div class="sidebar__folder-items open" id="folder-meta">
                        <div class="sidebar__item" onclick="loadContent('why-this-site')">01 - why-this-site</div>
                        <div class="sidebar__item" onclick="loadContent('design-decisions')">02 - design-decisions</div>
                    </div>
                </div>
            </div>
            <div class="sidebar__graph">
                <svg id="knowledge-graph" aria-hidden="true"></svg>
            </div>
            
            <div class="sidebar__footer">
                <a href="https://github.com/aadityaincode" target="_blank" title="GitHub">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                </a>

                <a href="mailto:aadityaincode@gmail.com" title="Email">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="5" width="18" height="14" rx="2"/>
                        <polyline points="3,7 12,13 21,7"/>
                    </svg>
                </a>

                <a href="https://linkedin.com/in/aadityadhungana" target="_blank" title="LinkedIn">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                        <path d="M4.98 3.5C4.98 5 3.88 6.1 2.5 6.1S0 5 0 3.5 1.1.9 2.5.9s2.48 1.1 2.48 2.6zM.5 24h4V7.9h-4V24zM8.5 7.9h3.8v2.2h.1c.5-1 1.8-2.2 3.8-2.2 4 0 4.7 2.6 4.7 6V24h-4v-7.5c0-1.8 0-4.1-2.5-4.1s-2.9 2-2.9 4v7.6h-4V7.9z"/>
                    </svg>
                </a>
            </div>
        </aside>
        
        <!-- MAIN CONTENT -->
        <main class="main">
            <div class="container">
                <!-- HEADER -->
                <header class="header">
                    <h1 class="header__title blinking-cursor"><span id="typewriter"></span><span class="caret">|</span></h1>
                </header>
                
        <!-- WHOAMI CARD -->
        <article class="card whoami">
            <h2 class="card__title">whoami</h2>
            <div class="card__content">
                <div class="card__text-block">
                    <p class="card__text">
                        computer science student interested in data, systems, and how people organize complexity.
                    </p>
                </div>
                <div class="card__text-block">
                    <p class="card__text">
                        i like building things slowly, thinking in markdown, and understanding 
                        <span class="card__highlight">why</span> systems work the way they do.
                    </p>
                </div>
                <div class="card__text-block">
                    <p class="card__text">
                        also, i like prog music.
                    </p>
                </div>
            </div>
        </article>
        
        <!-- HINT CARD -->
        <aside class="hint">
            <h3 class="hint__title">
                <span id="hint-text">hint</span>
            </h3>
            <div class="hint__body">
                <a href="javascript:void(0)" class="hint__link" onclick="highlightSidebar()">explore vault</a>
            </div>
        </aside>
            </div>
        </main>
    </div>
    
    <script>
        // Content database - add your actual content here
        const contentData = {
            'terminal':{ title:'terminal', type:'terminal', blocks:[] },
            'whoami': {
                title: 'whoami',
                type: 'landing',
                showHint: true,
                blocks: [
                    'computer science student interested in data, systems, and how people organize complexity.',
                    'i like building things slowly, thinking in markdown, and understanding <span class="card__highlight">why</span> systems work the way they do.',
                    'also, i like prog music.'
                ]
            },
            'fts': {
                title: '01- FTS',
                type: 'project',
                blocks: [
                    'First project. Most enjoyable so far. The login/signup flow was a surprisingly intense learning experience.',
                    'Status: paused for now, may revisit later.'
                ],
                github: 'https://github.com/aadityaincode/Football-Training-System.git',
                demo: null // or add a demo link if you have one
            },
            'bmats': {
                title: '03 - BMATS',
                type: 'project',
                blocks: [
                    'BMATS project description goes here.'
                ],
                github: 'https://github.com/yourusername/bmats',
                demo: null
            },
            'simpltimer': {
                title: '04 - SimplTimer',
                type: 'project',
                blocks: [
                    'SimplTimer project description goes here.'
                ],
                github: 'https://github.com/yourusername/simpltimer',
                demo: null
            },
            'touchline': {
                title: '02 - TouchLine',
                type: 'project',
                blocks: [
                    'A Discord bot for football fans that provides team information and match updates through simple commands.',
                    'Status: paused for now, may revisit later.'
                ],
                github: 'https://github.com/aadityaincode/TouchLine.git',
                demo: null
            },
            'learning': {
                title: '01 - learning',
                type: 'note',
                blocks: [
                    'active focus: networks, discrete mathematics, and whatever problem i\'m trying to solve that week.',
                    'learning by breaking things: build something, watch it fail, figure out why. repeat until it makes sense.',
                    'reality check: my "to-learn" list is longer than my "learned" list. working on being okay with that.'
                ]
            },
            'music': {
                title: '02 - music',
                type: 'note',
                blocks: [
                    'music taste: progressive. anything long, complex, or that builds over time. bonus points for weird time signatures.',
                    'why: every listen reveals something new you missed before.'
                ]
            },
            'how-i-work': {
                title: '01 - how-i-work',
                type: 'note',
                blocks: [
                    'planning first: i diagram workflows, map systems, and think through edge cases before writing code. sometimes too much, but it saves time later.',
                    'visual learner: flowcharts and system diagrams help me understand complexity.',
                    'obsidian for everything: notes, brainstorming, workflows, learning. <a href="#" onclick="loadContent(\'design-decisions\'); return false;" style="color: var(--accent-purple); text-decoration: underline;">this vault-based site design came directly from my obsidian setup</a>.',
                    'process: brainstorm → understand → plan → build. no shortcuts.',
                    'i work deliberately: slow start, attention to details, patience over speed.'
                ]
            },
            'why-this-site': {
                title: '01 - why-this-site',
                type: 'note',
                blocks: [
                    'got motivated after seeing a series of thoughtful personal sites.',
                    'wanted to build something that reflects how i actually think and work.',
                    'this vault structure came naturally - it\'s how i organize everything in obsidian anyway.',
                    'also: building it was a good excuse to learn by doing.'
                ]
            },
            'design-decisions': {
                title: '02 - design-decisions',
                type: 'note',
                blocks: [
                    'heavily inspired by obsidian.',
                    'vault structure, sidebar navigation, dark theme - i already live in this system. why design something different?',
                    'monaspace krypton font: found it in some random reddit thread. liked the look and downloaded it.',
                ]
            },
            'skills': {
                title: 'skills',
                type: 'skills',
                blocks: []
            },
        };
        
        // Helper: process colon-prefixed concepts with semantic label
        function processConceptLabels(text) {
            const colonIndex = text.indexOf(':');
            if (colonIndex === -1) return text;

            // Only treat as label if colon appears early (semantic rule)
            if (colonIndex > 40) return text;

            const label = text.slice(0, colonIndex + 1);
            const rest = text.slice(colonIndex + 1);

            return `<span class="label">${label}</span>${rest}`;
        }

        // Toggle folder open/close
        function toggleFolder(folderId) {
            const items = document.getElementById(`folder-${folderId}`);
            const toggle = document.getElementById(`toggle-${folderId}`);
            
            items.classList.toggle('open');
            toggle.classList.toggle('open');
        }
        
        // Render content in main area
        function renderContent(contentId) {
            const container = document.querySelector('.container');
            const data = contentData[contentId];

            // Special renderer for skills (skills card grid overlay)
            if (data.type === 'skills') {
                container.innerHTML = `
                    <div class="skills-grid">
                    <div class="skill-card"><img src="logos/python.svg" alt="Python"></div>
                    <div class="skill-card"><img src="logos/js.svg" alt="JavaScript"></div>
                    <div class="skill-card"><img src="logos/java.svg" alt="Java"></div>
                    <div class="skill-card"><img src="logos/c.svg" alt="C"></div>
                    <div class="skill-card"><img src="logos/html.svg" alt="HTML"></div>
                    </div>
                `;
                const cards = container.querySelectorAll('.skill-card');
                const positions = [];
                const minDist = 18; // % distance roughly one card width

                cards.forEach((card) => {
                  let x, y, safe = false, tries = 0;

                  while (!safe && tries < 50) {
                    x = Math.random() * 80 + 5;
                    y = Math.random() * 80 + 5;
                    safe = true;

                    for (const p of positions) {
                      const dx = x - p.x;
                      const dy = y - p.y;
                      if (Math.sqrt(dx*dx + dy*dy) < minDist) {
                        safe = false;
                        break;
                      }
                    }
                    tries++;
                  }

                  positions.push({x, y});
                  card.style.left = x + '%';
                  card.style.top = y + '%';
                  card.style.animationDelay = (Math.random() * 3) + 's';
                });
                return;
            }

            // Special renderer for terminal note
            if (data.type === 'terminal') {
                container.innerHTML = `
                    <div class="card">
                        <h2 class="card__title">terminal</h2>
                        <div class="card__content">
                            <div class="card__text-block">
                                <pre class="card__text" id="terminal-ui">type \`help\` to begin.</pre>
                            </div>
                            <div class="card__text-block">
                                <input id="terminal-input" 
                                       placeholder="> enter command" 
                                       style="width:100%;background:#0a0a0a;border:1px solid #333;border-radius:6px;padding:10px;color:#22c55e;font-family:'Monaspace Krypton',monospace;">
                            </div>
                        </div>
                    </div>
                `;
                setTimeout(initTerminalUI, 50);
                return;
            }

            if (!data) return;
            
            // Build content HTML
            let blocksHTML = '';
            data.blocks.forEach(block => {
                blocksHTML += `
                    <div class="card__text-block">
                        <p class="card__text">${processConceptLabels(block)}</p>
                    </div>
                `;
            });
            
            // Build links section for projects
            let linksHTML = '';
            if (data.type === 'project' && (data.github || data.demo)) {
                linksHTML = '<div class="card__text-block" style="display: flex; gap: 1rem; align-items: center;">';
                
                if (data.github) {
                    linksHTML += `
                        <a href="${data.github}" target="_blank" rel="noopener noreferrer" 
                           style="color: var(--accent-purple); text-decoration: none; display: inline-flex; align-items: center; gap: 0.5rem; transition: var(--transition);"
                           onmouseover="this.style.color='var(--accent-pink)'" 
                           onmouseout="this.style.color='var(--accent-purple)'">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                            GitHub
                        </a>
                    `;
                }
                
                if (data.demo) {
                    linksHTML += `
                        <a href="${data.demo}" target="_blank" rel="noopener noreferrer"
                           style="color: var(--accent-purple); text-decoration: none; display: inline-flex; align-items: center; gap: 0.5rem; transition: var(--transition);"
                           onmouseover="this.style.color='var(--accent-pink)'" 
                           onmouseout="this.style.color='var(--accent-purple)'">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                <polyline points="15 3 21 3 21 9"></polyline>
                                <line x1="10" y1="14" x2="21" y2="3"></line>
                            </svg>
                            Live Demo
                        </a>
                    `;
                }
                
                linksHTML += '</div>';
            }
            
            // Build header section only for landing page
            let headerHTML = '';
            if (data.type === 'landing') {
                headerHTML = `
                    <header class="header">
                        <h1 class="header__title">
                            <span id="typewriter"></span><span class="caret">|</span>
                        </h1>
                    </header>
                `;
            }
            
            // Build hint section only if showHint is true (for landing page)
            let hintHTML = '';
            if (data.showHint) {
                hintHTML = `
                    <aside class="hint">
                        <h3 class="hint__title">
                            <span id="hint-text">hint</span>
                        </h3>
                        <div class="hint__body">
                            <a href="javascript:void(0)" class="hint__link" onclick="highlightSidebar()">explore vault</a>
                        </div>
                    </aside>
                `;
            }
            
            // Update container with new content
            container.innerHTML = `
                ${headerHTML}
                
                <article class="card">
                    <h2 class="card__title">${data.title}</h2>
                    <div class="card__content">
                        ${blocksHTML}
                        ${linksHTML}
                    </div>
                </article>
                
                ${hintHTML}
            `;
            // Restart typewriter effect for landing page after re-render
            if (data.type === 'landing') {
                requestAnimationFrame(() => {
                    startTypewriter();
                });
            }
            // restart hint animation if present
            requestAnimationFrame(startTerminalHint);       
        }
        
        // Load content when file is clicked
        function loadContent(contentId) {
            document.body.classList.toggle('skills-active', contentId === 'skills');
            // Remove active class from all items
            document.querySelectorAll('.sidebar__item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to clicked item
            event.currentTarget.classList.add('active');
            
            // Render the content
            renderContent(contentId);
            if (contentId === 'socials') {
                highlightSidebar();
            }
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // Typewriter effect for header
        const textToType = "it's aaditya.";
        let charIndex = 0;
        let typeTimeout = null;
        let typeInterval = null;

        function startTypewriter(skipInitialDelay = false) {
            clearInterval(typeInterval);
            clearTimeout(typeTimeout);

            charIndex = 0;
            const element = document.getElementById('typewriter');
            if (!element) return;
            element.textContent = '';
            // Always reset cursor state before typing
            if (element.parentElement) {
                element.parentElement.classList.remove('blinking-cursor');
            }
            // Hide caret during first typewriter run
            const caret = element.parentElement?.querySelector('.caret');
            if (caret) caret.style.visibility = 'hidden';
            if (caret) caret.classList.remove('blink');
            document.querySelectorAll('.header__title .cursor').forEach(c => c.style.visibility = 'hidden');
            // Remove blinking-cursor so ::after is not shown
            if (element.parentElement) {
                element.parentElement.classList.remove('blinking-cursor');
            }

            // FIX 1: Start typewriter synchronously, no initial timeout
            typeNextChar();
        }

        function typeNextChar() {
            const element = document.getElementById('typewriter');
            if (!element) return;
            if (charIndex < textToType.length) {
                element.textContent += textToType.charAt(charIndex);
                charIndex++;
                const speed = 90;
                typeTimeout = setTimeout(typeNextChar, speed);
            } else {
                setTimeout(() => {
                const element = document.getElementById("typewriter");
                if (!element || !element.parentElement) return;

                const caret = element.parentElement.querySelector(".caret");
                if (caret) {
                    caret.style.visibility = "visible";
                    caret.classList.add("blink");
                }
                }, 350);
            }
        }
        let isFirstCommand = true;
        function runBootTerminal() {
            const terminal = document.getElementById('boot-terminal');
            const output = document.getElementById('terminal-output');
            const cursor = terminal.querySelector('.cursor');

            const PROMPT = 'guest@vault ~ % ';
            
            const steps = [
                { type: 'command', text: 'npm run aadityaimcode\b\b\b\b\bncode' },
                { type: 'output', lines: [
                    '> aadityaincode@0.1.0 dev',
                    '> vault',
                    '',
                    'initializing knowledge graph...',
                    'loading markdown nodes...',
                    'resolving links...',
                    '',
                    'ready in 312 ms',
                    '',
                    '➜  local:   http://localhost:5173',
                    '➜  mode:    read-only',
                    '➜  hint:    explore the vault'
                ]}
            ];

            let stepIndex = 0;
            let charIndex = 0;
            let lineIndex = 0;

            // Human-like typing with realistic patterns
            function getTypingSpeed(char, prevChar, afterError = false, isStartOfWord = false) {
                const baseSpeed = 130;
                
                // Typing patterns that feel human
                const commonChars = 'etaoinshrdlu';
                const vowels = 'aeiou';
                const commonPairs = ['th', 'he', 'in', 'er', 'an', 'ed', 'nd', 'ha', 'en', 'es'];
                
                let speed = baseSpeed;
                
                // After error: much slower, more careful
                if (afterError) return baseSpeed + 80 + Math.random() * 60;
                
                // Start of word: slight hesitation (thinking)
                if (isStartOfWord) speed += 40;
                
                // Common characters: faster (muscle memory)
                if (commonChars.includes(char.toLowerCase())) speed -= 25;
                
                // Common digraphs: even faster (typing flow)
                const pair = (prevChar + char).toLowerCase();
                if (commonPairs.includes(pair)) speed -= 35;
                
                // Vowels after consonants: smooth flow
                if (prevChar && !vowels.includes(prevChar.toLowerCase()) && vowels.includes(char.toLowerCase())) {
                    speed -= 15;
                }
                
                // Space: tiny pause (word boundary)
                if (char === ' ') speed += 60;
                
                // Special characters: slower (need to think/reach)
                if ('!@#$%^&*()_+-=[]{}|;:,.<>?/'.includes(char)) speed += 45;
                
                // Random micro-variation (human inconsistency)
                speed += (Math.random() - 0.5) * 50;
                
                return Math.max(65, speed); // Never too fast
            }

            function processNextStep() {
                if (stepIndex >= steps.length) {
                    // All done - cursor idles, then fade
                    cursor.style.visibility = 'visible'; // Make sure cursor is visible
                    cursor.style.display = 'inline';
                    cursor.classList.add('idle');
                    setTimeout(() => {
                        terminal.classList.add('boot-fade');
                        setTimeout(() => {
                            terminal.remove();
                            // Add delay before starting typewriter
                            setTimeout(() => {
                                startTypewriter();
                                // Also start hint animation after typewriter starts
                                setTimeout(() => {
                                    startTerminalHint();
                                }, 500);
                            }, 400); // Delay after terminal removal
                        }, 650);
                    }, 1200);
                    return;
                }

                const step = steps[stepIndex];
                cursor.style.display = 'none'; // hide cursor while processing

                if (step.type === 'command') {
                    typeCommand(step.text, stepIndex > 0 && steps[stepIndex - 1].type === 'error');
                } else if (step.type === 'error') {
                    output.innerHTML += `<span class="error">${step.text}</span>\n`;
                    stepIndex++;
                    setTimeout(processNextStep, 450); // pause after showing error
                } else if (step.type === 'clear') {
                    output.innerHTML = '';
                    stepIndex++;
                    setTimeout(processNextStep, 150);
                } else if (step.type === 'pause') {
                    stepIndex++;
                    setTimeout(processNextStep, step.duration);
                } else if (step.type === 'output') {
                    lineIndex = 0;
                    printOutput(step.lines);
                }
            }

            function typeCommand(command, afterError = false) {
                // Print prompt once
                if (charIndex === 0) {
                    output.innerHTML += `<span class="prompt">${PROMPT}</span>`;

                    const delay = isFirstCommand ? 0 : 180;
                    isFirstCommand = false;

                    setTimeout(() => {
                        typeNextChar(command, afterError);
                    }, delay);
                    return;
                }

                typeNextChar(command, afterError);
            }

            function typeNextChar(command, afterError) {
                if (charIndex < command.length) {
                    const char = command[charIndex];
                    const prevChar = charIndex > 0 ? command[charIndex - 1] : '';
                    const isStartOfWord = prevChar === ' ' || charIndex === 0;

                    if (char === '\b') {
                        output.innerHTML = output.innerHTML.slice(0, -1);
                    } else {
                        output.innerHTML += char;
                    }
                    charIndex++;

                    const speed = getTypingSpeed(char, prevChar, afterError, isStartOfWord);
                    setTimeout(() => typeNextChar(command, afterError), speed);
                } else {
                    output.innerHTML += '\n';
                    charIndex = 0;
                    stepIndex++;

                    // natural pause after finishing command
                    setTimeout(processNextStep, 700);
                }
            }

            function printOutput(lines) {
                if (lineIndex < lines.length) {
                    const line = lines[lineIndex];
                    output.innerHTML += line + '\n';
                    lineIndex++;
                    
                    let speed = 180 + Math.random() * 90; // Add variation
                    
                    if (line.startsWith('initializing') || line.startsWith('loading')) {
                        speed = 200 + Math.random() * 100; // "Working" lines vary
                    } else if (line.startsWith('➜')) {
                        speed = 160 + Math.random() * 80;
                    } else if (line === '') {
                        speed = 25 + Math.random() * 20;
                    } else if (line.startsWith('ready')) {
                        speed = 320 + Math.random() * 120; // Pause to read "ready"
                    }
                    
                    setTimeout(() => printOutput(lines), speed);
                } else {
                    stepIndex++;
                    setTimeout(processNextStep, 400);
                }
            }

            // Start the sequence with an intentional pause before typing
            setTimeout(() => {
                processNextStep();
            }, 900);
        }

        document.addEventListener('DOMContentLoaded', () => {
            if (!sessionStorage.getItem('booted')) {
                sessionStorage.setItem('booted', 'true');
                runBootTerminal();
                // Don't call startTypewriter here - it's called after terminal finishes
            } else {
                const boot = document.getElementById('boot-terminal');
                if (boot) boot.remove();
                
                // Add a small delay before starting typewriter for returning visitors
                setTimeout(() => {
                    startTypewriter();
                }, 300); // Small delay so it feels natural
            }
            
            // Start hint animation after a small delay to ensure element exists
            setTimeout(() => {
                startTerminalHint();
            }, 100);
        });

        function highlightSidebar() {
            const sidebar = document.querySelector('.sidebar');
            if (!sidebar) return;

            sidebar.classList.add('glow');

            setTimeout(() => {
                sidebar.classList.remove('glow');
            }, 2200);
        }

        // ==== PERSPECTIVE DEPTH GRID ====
        (function initPerspectiveGrid() {
            const canvas = document.getElementById('wave-bg');
            if (!canvas) {
                console.error('Canvas #wave-bg not found');
                return;
            }

            const ctx = canvas.getContext('2d');
            if (!ctx) {
                console.error('Could not get 2d context');
                return;
            }

            let width, height;
            let mouseX = 0;
            let mouseY = 0;
            let time = 0;

            function resizeCanvas() {
                width = canvas.width = window.innerWidth;
                height = canvas.height = window.innerHeight;
                mouseX = width / 2;
                mouseY = height / 2;
            }

            window.addEventListener('resize', resizeCanvas);

            document.addEventListener('mousemove', (e) => {
                // Don't update if mouse is over sidebar (left 300px)
                if (e.clientX < 300) {
                    return;
                }

                mouseX = e.clientX;
                mouseY = e.clientY;
            });

            // Vanishing point based on mouse
            function getVanishingPoint() {
                const centerX = width / 2;
                const centerY = height / 2;

                // Mouse shifts the vanishing point slightly
                const offsetX = (mouseX - centerX) * 0.2;
                const offsetY = (mouseY - centerY) * 0.2;

                return {
                    x: centerX + offsetX,
                    y: centerY + offsetY - height * 0.1 // Slightly above center
                };
            }

            function drawPerspectiveGrid() {
                const vp = getVanishingPoint();
                const gridSize = 12;
                const spacing = 110;
                const depth = 15;
                const sidebarWidth = 300;
                const centerX = sidebarWidth + (width - sidebarWidth) / 2;

                // Check if we're on skills page
                const isSkillsPage = document.body.classList.contains('skills-active');

                if (isSkillsPage) {
                    // Skills mode: grid gets narrower and fades (no vanishing point)
                    const fadeDepth = height * 0.6;

                    // Draw vertical lines that get closer together and fade
                    for (let i = -gridSize; i <= gridSize; i++) {
                        const startX = centerX + i * spacing;
                        const startY = height;

                        // End position - lines get closer together as they recede
                        const widthScale = 0.7; // Lines compress to 70% width at the top
                        const endX = centerX + i * spacing * widthScale;
                        const endY = height - fadeDepth;

                        const gradient = ctx.createLinearGradient(startX, startY, endX, endY);
                        const distToMouse = Math.abs(mouseX - startX);
                        const mouseProximity = Math.max(0, 1 - distToMouse / 250);
                        const distFromCenter = Math.abs(i) / gridSize;
                        const baseOpacity = (1 - distFromCenter * 0.5) * 0.2;
                        const glowBoost = mouseProximity * 0.3;

                        gradient.addColorStop(0, `rgba(167, 139, 250, ${baseOpacity + glowBoost})`);
                        gradient.addColorStop(0.5, `rgba(167, 139, 250, ${(baseOpacity + glowBoost) * 0.5})`);
                        gradient.addColorStop(1, `rgba(167, 139, 250, 0)`);

                        ctx.beginPath();
                        ctx.moveTo(startX, startY);
                        ctx.lineTo(endX, endY);
                        ctx.strokeStyle = gradient;
                        ctx.lineWidth = 0.8 + mouseProximity * 0.8;
                        ctx.stroke();

                        if (mouseProximity > 0.2) {
                            const glowGradient = ctx.createLinearGradient(startX, startY, endX, endY);
                            glowGradient.addColorStop(0, `rgba(167, 139, 250, ${mouseProximity * 0.12})`);
                            glowGradient.addColorStop(0.5, `rgba(167, 139, 250, ${mouseProximity * 0.06})`);
                            glowGradient.addColorStop(1, `rgba(167, 139, 250, 0)`);
                            ctx.beginPath();
                            ctx.moveTo(startX, startY);
                            ctx.lineTo(endX, endY);
                            ctx.strokeStyle = glowGradient;
                            ctx.lineWidth = 4;
                            ctx.stroke();
                        }
                    }

                    // Horizontal lines getting narrower and fading
                    for (let d = 0; d < depth; d++) {
                        const progress = d / depth;
                        const yPos = height - (progress * fadeDepth);
                        const widthScale = 1 - progress * 0.3;
                        const distToMouseY = Math.abs(mouseY - yPos);
                        const mouseProximityY = Math.max(0, 1 - distToMouseY / 200);

                        ctx.beginPath();
                        for (let i = -gridSize; i <= gridSize; i++) {
                            const baseX = centerX + i * spacing * widthScale;
                            if (i === -gridSize) {
                                ctx.moveTo(baseX, yPos);
                            } else {
                                ctx.lineTo(baseX, yPos);
                            }
                        }

                        const baseOpacity = (1 - progress) * 0.2;
                        const opacity = baseOpacity + mouseProximityY * 0.25;
                        const lineWidth = (1 - progress * 0.5) * 0.8 + mouseProximityY * 0.7;

                        ctx.strokeStyle = `rgba(167, 139, 250, ${opacity})`;
                        ctx.lineWidth = lineWidth;
                        ctx.stroke();

                        if (mouseProximityY > 0.2) {
                            ctx.beginPath();
                            for (let i = -gridSize; i <= gridSize; i++) {
                                const baseX = centerX + i * spacing * widthScale;
                                if (i === -gridSize) {
                                    ctx.moveTo(baseX, yPos);
                                } else {
                                    ctx.lineTo(baseX, yPos);
                                }
                            }
                            ctx.strokeStyle = `rgba(167, 139, 250, ${mouseProximityY * 0.15 * (1 - progress)})`;
                            ctx.lineWidth = 4;
                            ctx.stroke();
                        }
                    }

                    // Dots
                    for (let d = 3; d < depth; d += 2) {
                        const progress = d / depth;
                        const yPos = height - (progress * fadeDepth);
                        const widthScale = 1 - progress * 0.3;

                        for (let i = -gridSize; i <= gridSize; i += 2) {
                            const x = centerX + i * spacing * widthScale;
                            const opacity = (1 - progress) * 0.3;
                            const size = (1 - progress * 0.5) * 1.5 + 0.5;

                            ctx.beginPath();
                            ctx.arc(x, yPos, size, 0, Math.PI * 2);
                            ctx.fillStyle = `rgba(167, 139, 250, ${opacity})`;
                            ctx.fill();
                        }
                    }
                } else {
                    // Regular mode: perspective with vanishing point
                    // Draw horizontal depth lines (going into the distance)
                    for (let i = -gridSize; i <= gridSize; i++) {
                        ctx.beginPath();

                        // Start from sidebar edge instead of screen edge
                        const startX = sidebarWidth + (width - sidebarWidth) / 2 + i * spacing;
                        const startY = height;

                        ctx.moveTo(startX, startY);
                        ctx.lineTo(vp.x, vp.y);

                        // Calculate distance from mouse to this line
                        const distToMouse = Math.abs(mouseX - startX);
                        const mouseProximity = Math.max(0, 1 - distToMouse / 250);

                        // Base opacity + mouse glow
                        const distFromCenter = Math.abs(i) / gridSize;
                        const baseOpacity = (1 - distFromCenter * 0.5) * 0.2;
                        const opacity = baseOpacity + mouseProximity * 0.3;

                        ctx.strokeStyle = `rgba(167, 139, 250, ${opacity})`;
                        ctx.lineWidth = 0.8 + mouseProximity * 0.8;
                        ctx.stroke();

                        // Add subtle glow for lines near mouse
                        if (mouseProximity > 0.2) {
                            ctx.beginPath();
                            ctx.moveTo(startX, startY);
                            ctx.lineTo(vp.x, vp.y);
                            ctx.strokeStyle = `rgba(167, 139, 250, ${mouseProximity * 0.12})`;
                            ctx.lineWidth = 4;
                            ctx.stroke();
                        }
                    }

                    // Draw perpendicular depth rings
                    for (let d = 0; d < depth; d++) {
                        const progress = d / depth;
                        const scale = 1 - progress * 0.95;

                        // Calculate Y position of this ring
                        const ringY = vp.y + (height - vp.y) * scale;
                        const distToMouseY = Math.abs(mouseY - ringY);
                        const mouseProximityY = Math.max(0, 1 - distToMouseY / 200);

                        ctx.beginPath();

                        for (let i = -gridSize; i <= gridSize; i++) {
                            const baseX = sidebarWidth + (width - sidebarWidth) / 2 + i * spacing;
                            const x1 = vp.x + (baseX - vp.x) * scale;
                            const y1 = ringY;

                            if (i === -gridSize) {
                                ctx.moveTo(x1, y1);
                            } else {
                                ctx.lineTo(x1, y1);
                            }
                        }

                        // Base opacity + mouse glow + fade with depth
                        const baseOpacity = (1 - progress) * 0.2;
                        const opacity = baseOpacity + mouseProximityY * 0.25;

                        ctx.strokeStyle = `rgba(167, 139, 250, ${opacity})`;
                        ctx.lineWidth = 0.8 + mouseProximityY * 0.7;
                        ctx.stroke();

                        // Add subtle glow to rings near mouse
                        if (mouseProximityY > 0.2) {
                            ctx.beginPath();
                            for (let i = -gridSize; i <= gridSize; i++) {
                                const baseX = sidebarWidth + (width - sidebarWidth) / 2 + i * spacing;
                                const x1 = vp.x + (baseX - vp.x) * scale;
                                const y1 = ringY;
                                if (i === -gridSize) {
                                    ctx.moveTo(x1, y1);
                                } else {
                                    ctx.lineTo(x1, y1);
                                }
                            }
                            ctx.strokeStyle = `rgba(167, 139, 250, ${mouseProximityY * 0.15})`;
                            ctx.lineWidth = 4;
                            ctx.stroke();
                        }
                    }

                    // Draw intersection dots - simple, no glow
                    for (let d = 3; d < depth; d += 2) {
                        const progress = d / depth;
                        const scale = 1 - progress * 0.95;
                        const ringY = vp.y + (height - vp.y) * scale;

                        for (let i = -gridSize; i <= gridSize; i += 2) {
                            const baseX = sidebarWidth + (width - sidebarWidth) / 2 + i * spacing;
                            const x = vp.x + (baseX - vp.x) * scale;
                            const y = ringY;

                            const opacity = (1 - progress) * 0.3;
                            const size = 1 + (1 - progress) * 1.5;

                            ctx.beginPath();
                            ctx.arc(x, y, size, 0, Math.PI * 2);
                            ctx.fillStyle = `rgba(167, 139, 250, ${opacity})`;
                            ctx.fill();
                        }
                    }
                }
            }

            function animate() {
                time += 1;
                ctx.clearRect(0, 0, width, height);

                drawPerspectiveGrid();

                requestAnimationFrame(animate);
            }

            // Initialize and start
            resizeCanvas();
            requestAnimationFrame(animate);
        })();
        // ==== KNOWLEDGE GRAPH (sidebar, visible + subtle motion) ====
        (function () {
            const svg = document.getElementById('knowledge-graph');
            if (!svg) return;

            // Nodes represent CONCEPTS, not files.
            // Click navigates to a representative entry point for that concept.
            // --- EXPLICIT NODE → SIDEBAR MAPPING ---
            const nodeTargetMap = {
                whoami: {
                    type: 'file',
                    target: 'whoami',
                    folder: null
                },
                projects: {
                    type: 'file',
                    target: 'fts',
                    folder: 'projects'
                },
                skills: {
                    type: 'file',
                    target: 'skills',
                    folder: null
                },
                learning: {
                    type: 'file',
                    target: 'learning',
                    folder: 'notes'
                },
                meta: {
                    type: 'file',
                    target: 'why-this-site',
                    folder: 'meta'
                }
            };

            // Clear in case of re-init
            svg.innerHTML = '';

            // Match sidebar size explicitly
            svg.setAttribute('viewBox', '0 0 200 140');
            svg.setAttribute('preserveAspectRatio', 'xMidYMid meet');

            // --- DENSITY TOGGLE (quiet, invisible, no UI) ---
            let dense = true;

            const sparseNodes = [
                { id: 'whoami', x: 100, y: 30 },
                { id: 'projects', x: 50, y: 90 }
            ];

            const denseNodes = [
                { id: 'whoami',   x: 100, y: 18 },
                { id: 'projects', x: 45,  y: 55 },
                { id: 'skills',   x: 155, y: 55 },
                { id: 'learning', x: 70,  y: 98 },
                { id: 'meta',     x: 130, y: 112 }
            ];

            const nodes = dense ? denseNodes : sparseNodes;

            const edges = dense
                ? [
                    ['whoami', 'projects'],
                    ['whoami', 'skills'],
                    ['whoami', 'learning'],
                    ['projects', 'learning'],
                    ['learning', 'meta']
                ]
                : [
                    ['whoami', 'projects']
                ];

            const nodeMap = {};
            nodes.forEach(n => nodeMap[n.id] = n);

            // Draw edges
            const edgeEls = edges.map(([a, b]) => {
                const n1 = nodeMap[a];
                const n2 = nodeMap[b];

                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', n1.x);
                line.setAttribute('y1', n1.y);
                line.setAttribute('x2', n2.x);
                line.setAttribute('y2', n2.y);
                line.classList.add('graph-edge');
                svg.appendChild(line);

                return { line, a: n1, b: n2 };
            });

            // Draw nodes (interactive: hover → highlight sidebar, click → navigate)
            const nodeEls = nodes.map((node) => {
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', node.x);
                circle.setAttribute('cy', node.y);
                circle.setAttribute('r', 4.5);
                circle.classList.add('graph-node');
                circle.style.cursor = 'pointer';
                circle.style.pointerEvents = 'all';

                // Hover → highlight sidebar item (use mapping)
                circle.addEventListener('mouseenter', () => {
                    const config = nodeTargetMap[node.id];
                    if (!config) return;
                    // Only highlight file targets
                    if (config.type === 'file' && config.target) {
                        const selector = '.sidebar__item, .sidebar__folder-skills';
                        document.querySelectorAll(selector).forEach(item => {
                            if (item.getAttribute('onclick')?.includes(`'${config.target}'`)) {
                                item.classList.add('active');
                            }
                        });
                    }
                });

                circle.addEventListener('mouseleave', () => {
                    const selector = '.sidebar__item, .sidebar__folder-skills';
                    document.querySelectorAll(selector)
                        .forEach(item => item.classList.remove('active'));
                });

                // Click → expand folder (if needed), then navigate (if file)
                circle.addEventListener('click', () => {
                    const config = nodeTargetMap[node.id];
                    if (!config) return;

                    // Expand folder first (if applicable)
                    if (config.folder) {
                        const folderEl = document.getElementById(`folder-${config.folder}`);
                        const toggleEl = document.getElementById(`toggle-${config.folder}`);

                        if (folderEl && !folderEl.classList.contains('open')) {
                            folderEl.classList.add('open');
                            toggleEl?.classList.add('open');
                        }
                    }

                    // Navigate only if this node represents a file
                    if (config.type === 'file' && config.target) {
                        const selector = '.sidebar__item, .sidebar__folder-skills';
                        const targetItem = [...document.querySelectorAll(selector)]
                            .find(el => el.getAttribute('onclick')?.includes(`'${config.target}'`));

                        if (targetItem) {
                            // Add glow effect for skills item
                            if (config.target === 'skills' && targetItem.classList.contains('sidebar__folder-skills')) {
                                targetItem.classList.add('glow');
                                setTimeout(() => {
                                    targetItem.classList.remove('glow');
                                }, 1200);
                            }
                            targetItem.click();
                        }
                    }
                });

                svg.appendChild(circle);
                return { node, circle };
            });

            // Subtle breathing animation (staggered, calm)
            let t = 0;
            function animate() {
                t += 0.02;

                nodeEls.forEach(({ node, circle }, i) => {
                    const delay = i * 0.6;
                    const dy = Math.sin(t - delay) * 1.4;
                    circle.setAttribute('cy', node.y + dy);
                });

                edgeEls.forEach(({ line, a, b }, i) => {
                    // Edges inherit node motion
                    const delayA = nodes.indexOf(a) * 0.6;
                    const delayB = nodes.indexOf(b) * 0.6;
                    const dy1 = Math.sin(t - delayA) * 1.4;
                    const dy2 = Math.sin(t - delayB) * 1.4;

                    line.setAttribute('y1', a.y + dy1);
                    line.setAttribute('y2', b.y + dy2);
                });

                requestAnimationFrame(animate);
            }

            animate();
        })();
        // ==== TERMINAL-LIKE HINT ANIMATION (RESTART-SAFE, RELIABLE) ====
        let hintInterval = null;

        function startTerminalHint() {
            const hintEl = document.getElementById('hint-text');
            if (!hintEl) return;

            stopTerminalHint(); // ensure no duplicates

            hintInterval = setInterval(() => {
                // FIX 2: stateless random binary/text mix, no stateful mutation
                const base = 'hint';
                let out = '';

                for (let i = 0; i < base.length; i++) {
                    if (Math.random() < 0.4) {
                        out += Math.random() < 0.5 ? '0' : '1';
                    } else {
                        out += base[i];
                    }
                }

                hintEl.innerHTML = out.replace(/[01]/g, b =>
                    `<span class="binary">${b}</span>`
                );
            }, 550);
        }

        function stopTerminalHint() {
            if (hintInterval) {
                clearInterval(hintInterval);
                hintInterval = null;
            }
        }

        let terminalUnlocked = localStorage.getItem('terminalUnlocked')==='true';
        function openTerminalNote(e){
        if(!terminalUnlocked){
            const key = prompt('Enter access key:');
            if(key!=='vault-1973'){alert('Invalid key');return;}
            window.unlockTerminal(key);
        }
        openTerminalOverlay();
        }

                window.unlockTerminal = function(key){ if(key==='vault-1973'){ localStorage.setItem('terminalUnlocked','true'); terminalUnlocked=true; document.querySelectorAll('.terminal-locked').forEach(el=>{el.classList.add('terminal-unlocked'); el.innerHTML='?? - terminal <span style="float:right">🔓</span>';}); }}

            </script>
            <script>
        // ===== FULLSCREEN TERMINAL OVERLAY =====
        const terminalOverlay = document.createElement('div');
        terminalOverlay.id = 'terminal-overlay';
        terminalOverlay.innerHTML = `
        <div id="terminal-window">
            <div id="terminal-header">
            <span>guest@vault:~$</span>
            <button id="terminal-close">×</button>
            </div>
            <pre id="overlay-output">Type 'help' for available commands\n</pre>
            <div id="terminal-line">
            <span id="prompt">guest@vault:~$</span>
            <span id="typed"></span><span id="overlay-cursor">█</span>
            <input id="overlay-input" autocomplete="off" />
            </div>
        </div>
        `;
        document.body.appendChild(terminalOverlay);

        const overlayStyles = document.createElement('style');
        overlayStyles.textContent = `
        #terminal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.95);z-index:9998;display:none}
        #terminal-window{position:absolute;inset:8%;border:1px solid #39ff14;color:#39ff14;font-family:'Monaspace Krypton',monospace;padding:20px;box-shadow:0 0 40px rgba(57,255,20,.15)}
        #terminal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
        #terminal-close{background:none;border:none;color:#39ff14;font-size:22px;cursor:pointer}
        #overlay-output{height:70%;overflow-y:auto;white-space:pre-wrap}
        #overlay-input{width:100%;background:#000;border:none;border-top:1px solid #39ff14;color:#39ff14;padding:8px;font-family:inherit;outline:none}
        #overlay-cursor{animation:blink 1s step-end infinite}
        @keyframes blink{50%{opacity:0}}
        #terminal-line{display:flex;align-items:center;gap:8px}
        #prompt{color:#39ff14}
        #typed{white-space:pre}
        #overlay-input{position:absolute;opacity:0}
        .cmd-line{color:#8bffb0;}
        .out-line{color:#39ff14;}
        .out-line:last-child{margin-bottom:10px;display:block;}
        `;
        document.head.appendChild(overlayStyles);

        // Remove logic that reads from document.documentElement.innerHTML or searches for access_key/vault-1973
        const SECRET_FLAG = "TBD";
        const files = {
        'README.txt': 'Welcome to my terminal, hacker.\nYour mission: find the secret I have been hiding from the world',
        'secrets/flag.txt': 'No secrets found. Mission pending.'
        };

        function printLine(t){
        const o = document.getElementById('overlay-output');
        o.innerHTML += `<span class="out-line">${t}</span>\n`;
        o.scrollTop = o.scrollHeight;
        }

        function handleCommand(cmd){
        if(cmd==='help'){
            printLine('ls - list files');printLine('cat <file> - read');printLine('whoami');printLine('mission');printLine('clear');printLine('exit');
            document.getElementById('overlay-output').innerHTML += `\n`;
            return;
        }
        else if(cmd==='whoami'){
            printLine('User: guest');printLine('Access Level: visitor');printLine('Objective: Find the secret');
            document.getElementById('overlay-output').innerHTML += `\n`;
            return;
        }
        else if(cmd==='mission'){
            printLine('Find the secret hidden in the vault.');
            document.getElementById('overlay-output').innerHTML += `\n`;
            return;
        }
        else if(cmd==='ls'){
            Object.keys(files).forEach(f=>printLine(f));
            document.getElementById('overlay-output').innerHTML += `\n`;
            return;
        }
        else if(cmd.startsWith('cat')){
            const f=cmd.split(' ')[1];printLine(files[f]||'file not found');
            document.getElementById('overlay-output').innerHTML += `\n`;
            return;
        }
        else if(cmd==='clear'){
            document.getElementById('overlay-output').textContent='';
            return;
        }
        else if(cmd==='exit'){
            closeTerminalOverlay();
            return;
        }
        else{
            printLine('unknown command');
            document.getElementById('overlay-output').innerHTML += `\n`;
            return;
        }
        }

        function openTerminalOverlay(){
        terminalOverlay.style.display='block';
        document.getElementById('overlay-input').focus();
        document.getElementById('typed').textContent = '';
        }
        function closeTerminalOverlay(){ terminalOverlay.style.display='none'; }

        terminalOverlay.addEventListener('keydown',e=>{ if(e.key==='Escape') closeTerminalOverlay(); });
        document.getElementById('terminal-close').onclick=closeTerminalOverlay;
        const inputEl = document.getElementById('overlay-input');
        const typedEl = document.getElementById('typed');
        inputEl.addEventListener('keydown', e => {
        if(e.key === 'Backspace'){
            typedEl.textContent = typedEl.textContent.slice(0,-1);
            e.preventDefault();
        } else if(e.key === 'Enter'){
            const v = typedEl.textContent;
            typedEl.textContent = '';
            document.getElementById('overlay-output').innerHTML += `<span class="cmd-line">guest@vault:~$ ${v}</span>\n`;
            handleCommand(v.trim());
            e.preventDefault();
        } else if(e.key.length === 1){
            typedEl.textContent += e.key;
            e.preventDefault();
        }
        });

        // Fast live binary for ?? - terminal
        (function() {
            const terminalNote = document.querySelector('.terminal-locked.note-item');
            if (!terminalNote) return;
            
            const binSpan = terminalNote.querySelector('.bin-label');
            if (!binSpan) return;
            
            const baseText = binSpan.getAttribute('data-base') || '??';
            let intervalId;
            
            function randomBinary(len) {
                return Array.from({length: len}, () => Math.random() < 0.5 ? '0' : '1').join('');
            }
            
            terminalNote.addEventListener('mouseenter', () => {
                binSpan.textContent = randomBinary(baseText.length);
                intervalId = setInterval(() => {
                    binSpan.textContent = randomBinary(baseText.length);
                }, 150);  // changes every 150ms 
            });
            
            terminalNote.addEventListener('mouseleave', () => {
                clearInterval(intervalId);
                binSpan.textContent = baseText;
            });
        })();
</script>
</body>
</html>